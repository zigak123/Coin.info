var app=angular.module('coinTicker',['ngMaterial','infinite-scroll','ui.router','ngAnimate','ngMessages','ngImgCrop','ngFileUpload']);app.value('THROTTLE_MILLISECONDS',4e3),app.config(function(b,c,e,f,g){g.configure({progressSize:50,duration:1e3}),b.theme('default').primaryPalette('blue').accentPalette('pink'),b.theme('darkDefault').primaryPalette('blue').accentPalette('purple').dark(),b.alwaysWatchTheme(!0);c.state({name:'signedin',url:'/user/{userId}',component:'userDetails',resolve:{userStatus:function(u){return u.authenticated({username:!0,avatarImage:!0})}}}),c.state({name:'login',url:'/login',component:'login'}),c.state({name:'coinDetails',url:'/{coinName}',component:'coinDetails',params:{coin_data:null}}),c.state({name:'profile',url:'/profile',component:'profile'}),c.state({name:'about',url:'/about',templateUrl:'/public/templates/about.html'}),c.state({name:'news',url:'/news',component:'news'}),c.state({name:'coinlist',url:'/',component:'coinlist'}),c.state({name:'article',url:'/news/article/{articleName}',component:'article',params:{article:null}}),e.otherwise('/')}),app.directive('priceChangeLabel',function(){return{restrict:'E',scope:{priceInfo:'=info'},template:'<div layout="row" align="end">                    <md-icon style="height: 24px; margin-left: 0px; margin-right: 0px" md-svg-src={{price_arrow}}></md-icon>                      <span style="font-weight: 400" class="md-caption" ng-style="style"> {{temp}} % </span>              </div>',link:function(c){n=c.priceInfo.length,c.temp=1<c.priceInfo[n-1]/c.priceInfo[n-31]?c.priceInfo[n-1]/c.priceInfo[n-31]-1:-1*(1-c.priceInfo[n-1]/c.priceInfo[n-31]),c.temp=numeral(100*c.temp).format('0,0.00'),0>c.temp?(c.price_arrow='public/images/arrow_drop.svg',c.style={color:'red'}):(c.price_arrow='public/images/arrow_up.svg',c.style={color:'limegreen'})}}}),app.directive('sl',function(){return{link:function(f,g,j){g=d3.select(g[0]);var k=g,l=f.item.lineData,o=j.min===void 0?d3.min(l):+j.min,p=j.max===void 0?d3.max(l):+j.max;g.text('');var q=j.r||0,s=q,t=k.node().clientWidth;t=64;var u=+getComputedStyle(g.node())['font-size'].replace('px','');k.attr({width:t,height:u});var v=d3.scale.linear().domain([0,l.length-1]).range([s,t-s]),A=d3.scale.linear().domain([o,p]).range([u-s,s]),B=k.append('path').data(l).attr('d','M'+l.map(function(D,E){return[v(E),A(D)]}).join('L')),C=k.selectAll('circle').data(l).enter().append('circle').attr('r',q).attr('cx',function(D,E){return v(E)}).attr('cy',function(D){return A(D)})},restrict:'E',replace:!0,template:'<svg ng-transclude class="sl"></svg>',transclude:!0}}),app.directive('imageCheck',function(b){return{scope:!1,link:function(e,f){null==e.article.urlToImage&&(e.article.urlToImage='default'==b.currentTheme?'public/images/baseline_broken_image_black_48dp.png':'public/images/baseline_broken_image_white_48dp.png'),f.bind('error',function(){e.article.urlToImage='default'==b.currentTheme?'public/images/baseline_broken_image_black_48dp.png':'public/images/baseline_broken_image_white_48dp.png'}),f.bind('load',function(){f.removeClass('imageLoad')}),b.$watch('currentTheme',function(){'public'==e.article.urlToImage.split('/')[0]&&(e.article.urlToImage='default'==b.currentTheme?'public/images/baseline_broken_image_black_48dp.png':'public/images/baseline_broken_image_white_48dp.png')})}}}),app.directive('titleClamp',function(){return{link:function(c,e){$clamp(e[0],{clamp:4,useNativeClamp:!0})}}}),app.directive('userMenu',function(){return{templateUrl:'public/templates/userMenu.template.html'}}),app.component('article',{bindings:{article:'<'},templateUrl:'/public/templates/article.html',controller:function(b,c){b.article=c.article}});var CCC=CCC||{};CCC.STATIC=CCC.STATIC||{},CCC.STATIC.TYPE={TRADE:'0',FEEDNEWS:'1',CURRENT:'2',LOADCOMPLATE:'3',COINPAIRS:'4',CURRENTAGG:'5',TOPLIST:'6',TOPLISTCHANGE:'7',ORDERBOOK:'8',FULLORDERBOOK:'9',ACTIVATION:'10',TRADECATCHUP:'100',NEWSCATCHUP:'101',TRADECATCHUPCOMPLETE:'300',NEWSCATCHUPCOMPLETE:'301'},CCC.STATIC.CURRENCY=CCC.STATIC.CURRENCY||{},CCC.STATIC.CURRENCY.SYMBOL={BTC:'\u0243',LTC:'\u0141',DAO:'\xD0',USD:'$',CNY:'\xA5',EUR:'\u20AC',GBP:'\xA3',JPY:'\xA5',PLN:'z\u0142',RUB:'\u20BD',ETH:'\u039E',GOLD:'Gold g',INR:'\u20B9',BRL:'R$'},CCC.STATIC.CURRENCY.getSymbol=function(b){return CCC.STATIC.CURRENCY.SYMBOL[b]||b},CCC.STATIC.UTIL={exchangeNameMapping:{CCCAGG:'CryptoCompare Index',BTCChina:'BTCC'},isMobile:function(b){return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))},convertToMB:function(b){return(parseInt(b,10)/1024/1024).toFixed(2)+' MB'},getNameForExchange:function(b){return this.exchangeNameMapping.hasOwnProperty(b)?this.exchangeNameMapping[b]:b},noExponents:function(b){var c=(b+'').split(/[eE]/);if(1==c.length)return c[0];var e='',f=0>b?'-':'',g=c[0].replace('.',''),j=+c[1]+1;if(0>j){for(e=f+'0.';j++;)e+='0';return e+g.replace(/^\-/,'')}for(j-=g.length;j--;)e+='0';return g+e},reduceFloatVal:function(b){return b=parseFloat(b),1<b?(b=Math.round(100*b)/100,b):1e-5<=b?parseFloat(b.toPrecision(4)):1e-6<=b?parseFloat(b.toPrecision(3)):1e-7<=b?parseFloat(b.toPrecision(2)):parseFloat(b.toPrecision(1))},reduceReal:function(b){return b=parseFloat(b),parseFloat(b.toFixed(8))},convertCurrentKeyToAll:function(b){var c=b.split('~');return c[0]=CCC.STATIC.TYPE.CURRENTAGG,c[1]='CCCAGG',c.join('~')},convertCurrentKeyToTrade:function(b){var c=b.split('~');return c[0]=CCC.STATIC.TYPE.TRADE,c.join('~')},convertValueToDisplay:function(b,c,e,f,g){var j='',k=1;c=parseFloat(c);var l=Math.abs(c),o=2,p=2,q=4;return(!0===g&&(o=2,p=0,q=4),'8decimals'==f&&(o=4,p=8,q=8,1e-4>c&&1e-5<=c&&(q=4),1e-3>c&&1e-4<=c&&(q=5),0.01>c&&1e-3<=c&&(q=6),0.1>c&&0.01<=c&&(q=7)),''!=b&&(j=b+' '),0>c&&(k=-1),0==c)?j+'0':(1e-5>c&&1e-6<=c&&3<q&&(q=3),1e-6>c&&1e-7<=c&&2<q&&(q=2),1e-7>c&&1<q&&(q=1),'short'==f||'8decimals'==f?1e10<l?(l/=1e9,j+e(k*l,o)+' B'):1e7<l?(l/=1e6,j+e(k*l,o)+' M'):1e4<l?(l/=1e3,j+e(k*l,o)+' K'):'8decimals'==f&&100<=l?j+e(k*l,o):1<=l?j+e(k*l,p):j+(k*l).toPrecision(q):1<=l?j+e(k*l,p):j+this.noExponents((k*l).toPrecision(q)))}},CCC.TRADE=CCC.TRADE||{},CCC.TRADE.FLAGS={SELL:1,BUY:2,UNKNOWN:4},CCC.TRADE.FIELDS={T:0,M:0,FSYM:0,TSYM:0,F:0,ID:1,TS:2,Q:4,P:8,TOTAL:16},CCC.TRADE.DISPLAY=CCC.TRADE.DISPLAY||{},CCC.TRADE.DISPLAY.FIELDS={T:{Show:!1},M:{Show:!0,Filter:'Market'},FSYM:{Show:!0,Filter:'CurrencySymbol'},TSYM:{Show:!0,Filter:'CurrencySymbol'},F:{Show:!0,Filter:'TradeFlag'},ID:{Show:!0,Filter:'Text'},TS:{Show:!0,Filter:'Date',Format:'yyyy MMMM dd HH:mm:ss'},Q:{Show:!0,Filter:'Number',Symbol:'FSYM'},P:{Show:!0,Filter:'Number',Symbol:'TSYM'},TOTAL:{Show:!0,Filter:'Number',Symbol:'TSYM'}},CCC.TRADE.pack=function(b){var c=0,e='';for(var f in b)e+='~'+b[f],c|=this.FIELDS[f];return e.substr(1)+'~'+c.toString(16)},CCC.TRADE.unpack=function(b){var c=b.split('~'),e=c.length,f=c[e-1],g=parseInt(f,16),j={},k=0;for(var l in this.FIELDS)0===this.FIELDS[l]?(j[l]=c[k],k++):g&this.FIELDS[l]&&(j[l]=c[k],k++);return j},CCC.TRADE.getKey=function(b){return b.T+'~'+b.M+'~'+b.FSYM+'~'+b.TSYM},CCC.CURRENT=CCC.CURRENT||{},CCC.CURRENT.FLAGS={PRICEUP:1,PRICEDOWN:2,PRICEUNCHANGED:4,BIDUP:8,BIDDOWN:16,BIDUNCHANGED:32,OFFERUP:64,OFFERDOWN:128,OFFERUNCHANGED:256,AVGUP:512,AVGDOWN:1024,AVGUNCHANGED:2048},CCC.CURRENT.FIELDS={TYPE:0,MARKET:0,FROMSYMBOL:0,TOSYMBOL:0,FLAGS:0,PRICE:1,BID:2,OFFER:4,LASTUPDATE:8,AVG:16,LASTVOLUME:32,LASTVOLUMETO:64,LASTTRADEID:128,VOLUMEHOUR:256,VOLUMEHOURTO:512,VOLUME24HOUR:1024,VOLUME24HOURTO:2048,OPENHOUR:4096,HIGHHOUR:8192,LOWHOUR:16384,OPEN24HOUR:32768,HIGH24HOUR:65536,LOW24HOUR:131072,LASTMARKET:262144},CCC.CURRENT.DISPLAY=CCC.CURRENT.DISPLAY||{},CCC.CURRENT.DISPLAY.FIELDS={TYPE:{Show:!1},MARKET:{Show:!0,Filter:'Market'},FROMSYMBOL:{Show:!1},TOSYMBOL:{Show:!1},FLAGS:{Show:!1},PRICE:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},BID:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},OFFER:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},LASTUPDATE:{Show:!0,Filter:'Date',Format:'yyyy MMMM dd HH:mm:ss'},AVG:{Show:!0,' Filter':'Number',Symbol:'TOSYMBOL'},LASTVOLUME:{Show:!0,Filter:'Number',Symbol:'FROMSYMBOL'},LASTVOLUMETO:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},LASTTRADEID:{Show:!0,Filter:'String'},VOLUMEHOUR:{Show:!0,Filter:'Number',Symbol:'FROMSYMBOL'},VOLUMEHOURTO:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},VOLUME24HOUR:{Show:!0,Filter:'Number',Symbol:'FROMSYMBOL'},VOLUME24HOURTO:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},OPENHOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},HIGHHOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},LOWHOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},OPEN24HOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},HIGH24HOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},LOW24HOUR:{Show:!0,Filter:'Number',Symbol:'TOSYMBOL'},LASTMARKET:{Show:!0,Filter:'String'}},CCC.CURRENT.pack=function(b){var c=0,e='';for(var f in this.FIELDS)b.hasOwnProperty(f)&&(e+='~'+b[f],c|=this.FIELDS[f]);return e.substr(1)+'~'+c.toString(16)},CCC.CURRENT.unpack=function(b){var c=b.split('~'),e=c.length,f=c[e-1],g=parseInt(f,16),j={},k=0;for(var l in this.FIELDS)0===this.FIELDS[l]?(j[l]=c[k],k++):g&this.FIELDS[l]&&(j[l]='LASTMARKET'===l?c[k]:parseFloat(c[k]),k++);return j},CCC.CURRENT.getKey=function(b){return b.TYPE+'~'+b.MARKET+'~'+b.FROMSYMBOL+'~'+b.TOSYMBOL},CCC.CURRENT.getKeyFromStreamerData=function(b){var c=b.split('~');return c[0]+'~'+c[1]+'~'+c[2]+'~'+c[3]},CCC.noExponents=function(b){var c=(b+'').split(/[eE]/);if(1==c.length)return c[0];var e='',f=0>b?'-':'',g=c[0].replace('.',''),j=+c[1]+1;if(0>j){for(e=f+'0.';j++;)e+='0';return e+g.replace(/^\-/,'')}for(j-=g.length;j--;)e+='0';return g+e},CCC.filterNumberFunctionPolyfill=function(b,c){var e=Math.pow(10,c),f=Math.round(b*e)/e,g=f.toString().split('.');return g[0]=g[0].replace(/\B(?=(\d{3})+(?!\d))/g,','),g.join('.')},CCC.convertValueToDisplay=function(b,c,e,f){var g='',j=1;c=parseFloat(c);var k=Math.abs(c),l=2,o=2,p=4;return(!0===f&&(l=2,o=0,p=4),''!=b&&(g=b+' '),0>c&&(j=-1),0==c)?g+'0':(1e-5>c&&1e-6<=c&&3<p&&(p=3),1e-6>c&&1e-7<=c&&2<p&&(p=2),1e-7>c&&1e-8<=c&&1<p&&(p=1),'short'==e?1e10<k?(k/=1e9,g+CCC.filterNumberFunctionPolyfill(j*k,l)+' B'):1e7<k?(k/=1e6,g+CCC.filterNumberFunctionPolyfill(j*k,l)+' M'):1e4<k?(k/=1e3,g+CCC.filterNumberFunctionPolyfill(j*k,l)+' K'):1<=k?g+CCC.filterNumberFunctionPolyfill(j*k,o):g+(j*k).toPrecision(p):1<=k?g+CCC.filterNumberFunctionPolyfill(j*k,o):g+CCC.noExponents((j*k).toPrecision(p)))};var chartConfigh={type:'serial',theme:'default',categoryField:'time',dataDateFormat:'YYYY-MM-DD',mouseWheelZoomEnabled:!0,autoMarginOffset:0,marginBottom:0,marginLeft:8,marginRight:0,marginTop:8,plotAreaBorderAlpha:0,zoomOutButtonTabIndex:0,startDuration:0.35,fontFamily:'Roboto',categoryAxis:{parseDates:!0},chartCursor:{enabled:!0},chartScrollbar:{enabled:!1,graph:'g1',graphType:'line',scrollbarHeight:30},trendLines:[],graphs:[{balloonText:'Open:<b>[[open]]</b><br>Low:<b>[[low]]</b><br>High:<b>[[high]]</b><br>Close:<b>[[close]]</b><br>',closeField:'close',fillAlphas:0.9,fillColors:'green',highField:'high',id:'g1',lineColor:'green',lowField:'low',negativeFillColors:'red',negativeLineColor:'red',openField:'open',title:'Price:',type:'candlestick',valueField:'close'}],guides:[],valueAxes:[{id:'ValueAxis-1'}],allLabels:[],balloon:{},titles:[],dataProvider:null,'export':{enabled:!1}},timeConverter=function(b){var c=new Date(1e3*b),e=c.getFullYear(),f=10>c.getMonth()+1?'0'+(c.getMonth()+1):c.getMonth()+1,g=c.getDate(),j=10>c.getHours()?'0'+c.getHours():c.getHours(),k=10>c.getMinutes()?'0'+c.getMinutes():c.getMinutes();return e+'-'+f+'-'+g+' '+j+':'+k};app.component('coinDetails',{templateUrl:'/public/templates/coinDetails.html',controller:function(b,c,e,f,g,j,k){b.candleSizes=[{label:'15min',timeUnit:'minute',timeSize:15},{label:'1h',timeUnit:'hour',timeSize:1},{label:'2h',timeUnit:'hour',timeSize:2},{label:'6h',timeUnit:'hour',timeSize:6},{label:'1d',timeUnit:'day',timeSize:1}],b.zoomSizes=[{label:'1d',timeUnit:'day',timeSize:1},{label:'2d',timeUnit:'day',timeSize:2},{label:'1w',timeUnit:'day',timeSize:7},{label:'1M',timeUnit:'day',timeSize:30},{label:'All',timeUnit:'day',timeSize:2e3}],conversions={minute:1,hour:60,day:1440},b.selectedZ=b.zoomSizes[0],b.selectedC=b.candleSizes[4];var o;b.isLoading=!0,b.coin_data=e.coin_data,b.coin_data.TotalCoinSupply=numeral(b.coin_data.TotalCoinSupply).format('0,0');var p=function(v){b.volume=numeral(v.VOLUME24HOUR).format('0,0.00'),b.price=v.PRICE,b.data=v,b.high24hour=v.HIGH24HOUR?v.HIGH24HOUR:b.high24hour,b.low24hour=v.LOW24HOUR?v.LOW24HOUR:b.low24hour,temp=1<b.price/oldprice?b.price/oldprice-1:-1*(1-b.price/oldprice),b.change=numeral(100*temp).format('0,0.00'),b.price_color=0<=b.change?{color:'limegreen'}:{color:'red'},b.priceArrow=0<=b.change?'public/images/arrow_up.svg':'public/images/arrow_drop.svg',b.last_market=v.LASTMARKET;var A=0.1<=b.price?'0,0.00':'0,0.000';b.price=numeral(b.price).format(A)},q='default'===k.currentTheme?'default':'dark',o=AmCharts.makeChart('chartdiv',{type:'serial',theme:q,categoryField:'time',dataDateFormat:'YYYY-MM-DD',mouseWheelZoomEnabled:!0,autoMarginOffset:0,marginBottom:0,marginLeft:8,marginRight:16,marginTop:8,plotAreaBorderAlpha:0.1,zoomOutButtonTabIndex:0,startDuration:0.25,fontFamily:'Roboto',categoryAxis:{parseDates:!0},chartCursor:{enabled:!0},chartScrollbar:{enabled:!0,graph:'g1',graphType:'line',scrollbarHeight:30},trendLines:[],graphs:[{balloonText:'Open:<b>[[open]]</b><br>Low:<b>[[low]]</b><br>High:<b>[[high]]</b><br>Close:<b>[[close]]</b><br>',closeField:'close',fillAlphas:0.85,fillColors:'limegreen',highField:'high',id:'g1',lineColor:'limegreen',lowField:'low',negativeFillColors:'red',negativeLineColor:'red',openField:'open',title:'Price:',type:'candlestick',valueField:'close'}],guides:[],valueAxes:[{id:'ValueAxis-1'}],allLabels:[],balloon:{},titles:[],dataProvider:void 0,'export':{enabled:!1}}),t=function(){cc=b.selectedC.timeSize*conversions[b.selectedC.timeUnit],dd=b.selectedZ.timeSize*conversions[b.selectedZ.timeUnit],f({method:'GET',url:'https://min-api.cryptocompare.com/data/histo'+b.selectedC.timeUnit+'?fsym='+b.coin_data.Symbol+'&tsym=USD&limit='+dd/cc+'&aggregate='+b.selectedC.timeSize}).then(function(v){chartData=v.data.Data;for(var A=0;A<chartData.length;A++)chartData[A].time='day'==b.selectedC.timeUnit?timeConverter(chartData[A].time).split(' ')[0]:timeConverter(chartData[A].time);o.categoryAxis.minPeriod='day'==b.selectedC.timeUnit?'DD':'hour'==b.selectedC.timeUnit?'hh':'mm',o.dataDateFormat='day'==b.selectedC.timeUnit?o.dataDateFormat='YYYY-MM-DD':'YYYY-MM-DD JJ:NN',o.dataProvider=chartData,o.validateData()})};b.changeZoom=function(v){b.selectedZ!=v&&(b.selectedZ=v,t())},b.changeCandle=function(v){b.selectedC!=v&&(b.selectedC=v,t())},b.$on('$destroy',function(){g.unsub(b.coin_data.Symbol,p)}),f({method:'GET',url:'https://min-api.cryptocompare.com/data/histoday?fsym='+b.coin_data.Symbol+'&tsym=USD&limit=365'}).then(function(v){chartData=v.data.Data;for(var A=0;A<chartData.length;A++)chartData[A].time=timeConverter(chartData[A].time);n=v.data.Data.length,oldprice=v.data.Data[n-1].open,o.dataProvider=chartData,o.validateData(),o.zoomToIndexes(o.dataProvider.length-30,o.dataProvider.length-1),g.subscribe(e.coin_data.Symbol,p),b.isLoading=!1},function(v){console.log(v)}),function(){f({method:'GET',url:'https://min-api.cryptocompare.com/data/top/exchanges/full?fsym='+b.coin_data.Symbol+'&tsym=USD'}).then(function(v){b.coin_supply=numeral(v.data.Data.CoinInfo.TotalCoinsMined).format('0,0.00'),b.coin_block_number=numeral(v.data.Data.CoinInfo.BlockNumber).format('0,0.00')})}()}});app.component('coinlist',{controller:function(b,c,e,f,g,j,k,l){var o=0;b.showFAB=!1,b.coins=[];var p=function(){c({method:'GET',url:'https://api.coinmarketcap.com/v2/global/'}).then(function(q){b.marketData=q.data.data,b.marketData.quotes.USD.total_market_cap=numeral(q.data.data.quotes.USD.total_market_cap).format('0,0'),b.marketData.quotes.USD.total_volume_24h=numeral(q.data.data.quotes.USD.total_volume_24h).format('0,0')},function(q){console.log(q)})};p(),l(p,6e4),b.searchText=function(q){return c.get('search?text='+q).then(function(s){return s.data})},b.getSparklineData=function(q){return c({method:'GET',url:'https://min-api.cryptocompare.com/data/histoday?fsym='+q.Symbol+'&tsym=USD&limit=30'}).then(function(s){return s.data.Data.map(t=>t.close)},function(s){return s})},b.showDetails=function(q){f.go('coinDetails',{coin_data:q,coinName:q.FullName})},b.loadMore=function(){b.isbusy||(b.isbusy=!0,c.get('coinlist?skip='+o).then(function(q){var s=[];angular.forEach(q.data,function(t){var u=b.getSparklineData(t).then(function(v){t.lineData=v});s.push(u)}),k.all(s).then(function(){j(function(){[].push.apply(b.coins,q.data),b.isbusy=!1},250)})}),o+=10)}},templateUrl:'/public/templates/coinList.html'}),app.component('login',{controller:function(b,c,e){b.signIn=function(){e.signIn({logemail:b.clientEmail,logpassword:b.password}).then(function(f){401==f&&(b.signInForm.password.$setValidity('correctPassword',!1),b.signInForm.clientEmail.$setValidity('correctPassword',!1))}),b.$watchGroup(['clientEmail','password'],function(){b.signInForm.clientEmail.$setValidity('correctPassword',!0),b.signInForm.password.$setValidity('correctPassword',!0)})}},templateUrl:'public/templates/login.html'}),app.component('news',{controller:function(b,c,e,f,g,j,k){b.showFAB=!1,b.isbusy=!0,b.page=1,b.favoriteIcon='public/images/ic_favorite_border_black_24px.svg',b.articles=[],b.refreshNews=function(){b.isbusy||b.animate||(b.animate=!b.animate,k(function(){b.animate=!b.animate},1e4),b.LoadArticles(!0))},g.authenticated({articles:!0}).then(function(l){b.likedArticlesDict={};for(var o=0;o<l.length;o++)b.likedArticlesDict[l[o]]=!0}),b.LoadArticles=function(){b.isbusy=!0,b.page+=1,c.get('news?page='+b.page).then(function(o){if(o.data.articles!==void 0&&null!==o.data.articles)angular.forEach(o.data.articles,function(q){var s=new Date,t=new Date(q.publishedAt);t-=3.6e6;var u=Math.floor((s-t)/1e3),v=Math.floor(u/60),A=Math.floor(v/60),B=Math.floor(A/24);A-=24*B,v=v-60*(24*B)-60*A,u=u-60*(60*(24*B))-60*(60*A)-60*v,v=0<v?v+' min ':'',A=0<A?A+' h ':'',B=0<B?B+' d ':'',q.publishedAt=B+A+v}),[].push.apply(b.articles,o.data.articles),b.isbusy=!1;else{var p=new Error('bad response from newsAPI: '+o.data.message);throw p}})},b.scrollTop=function(){$('html, body').animate({scrollTop:$('#pageTop').offset().top},2e3)},b.readArticle=function(l){f.go('article',{articleName:l.title,article:l})},b.setIcon=function(l){return b.likedArticlesDict&&b.likedArticlesDict[l.title]?'public/images/ic_favorite_black_24px.svg':'public/images/ic_favorite_border_black_24px.svg'},b.likeArticle=function(l){if(b.likedArticlesDict){var p;l.title in b.likedArticlesDict?(p='/delete',delete b.likedArticlesDict[l.title]):(p='/save',b.likedArticlesDict[l.title]=!0),c({method:'POST',url:p,data:l}).then(function(){console.log('articles updated in mongoDB')})}},e.on(b),b.$on('$destroy',function(){e.off()})},templateUrl:'/public/templates/coinNews.html'});app.controller('priceTickerCtrl',function(b,c,e,f,g,j,k,l,o,p,q){var t='public/images/arrow_up.svg',u='public/images/arrow_drop.svg',v='public/images/minus.svg',A;k.currentTheme='default';var B=b.selectedItem;themes=[{icon:'/public/images/moon.svg',label:'Dark Theme'},{icon:'/public/images/ic_wb_sunny_black_24px.svg',label:'Light Theme'}],f.onSuccess({},function(E){A=g.authenticated({username:!0,avatarImage:!0,theme:!0}).then(function(F){b.tabName=F[0].username,b.imgSrc=String.fromCharCode.apply(null,F[0].avatarImage.data),k.currentTheme=F[0].theme,b.themeStuff='default'===k.currentTheme?themes[0]:themes[1]},function(){b.tabName='SIGN IN',b.imgSrc='/public/images/ic_account_circle_white_36pt.png'}),b.selectedItem=E.to().name,B=b.selectedItem}),f.onBefore({},function(E){b.selectedItem=E.to().name}),b.isSmall=function(){return q('xs')},b.profileClick=function(E){'SIGN IN'==b.tabName?e.go('login'):E.open()},b.changeTheme=function(){k.currentTheme='default'===k.currentTheme?'darkDefault':'default',b.themeStuff='default'===k.currentTheme?themes[0]:themes[1],j({method:'POST',url:'/theme',data:{theme:k.currentTheme}})},b.signOut=function(){j({method:'POST',url:'/user',data:{signout:!0}}).then(function(){e.go('login')})},b.close=function(E){l('left').close().then(function(){'user'===E&&'SIGN IN'!==b.tabName?e.go('signedin',{userId:b.tabName}):e.go(E)})},b.toggleLeft=function(E){return function(){l(E).toggle().then(function(){o.debug('toggle '+E+' is done')})}}('left'),b.isOpenLeft=function(){return l('left').isOpen()},b.$on('$mdMenuClose',function(){b.selectedItem=B});c.subscribe('BTC',function(E){b.btcPrice=numeral(E.PRICE).format('0,0.00'),b.btcArrow='1'===E.FLAGS?t:u,b.btcArrow='4'===E.FLAGS?v:b.btcArrow}),c.subscribe('ETH',function(E){b.ethPrice=numeral(E.PRICE).format('0,0.00'),b.ethArrow='1'===E.FLAGS?t:u,b.ethArrow='4'===E.FLAGS?v:b.ethArrow})});app.component('profile',{controller:function(b,c,e){b.sendForm=function(){var f={avatarImage:b.croppedDataUrl,username:b.userName,email:b.clientEmail,password:b.password};e({method:'POST',url:'/user',data:f}).then(function(g){200==g.data.status&&c.go('login')})}},templateUrl:'/public/templates/profile.html'}),app.directive('onScroll',function(b,c){'use strict';return{scope:!1,link:function(e){var j,k=!1,l=function(){k||(!1==e.showFAB&&0!=c.pageYOffset?e.showFAB=!0:0==c.pageYOffset&&!0==e.showFAB&&(e.showFAB=!1),k=!0,j=b(function(){k=!1},500))};angular.element(c).on('scroll',l),e.$on('$destroy',function(){angular.element(c).off('scroll',l)})}}});app.factory('scrollSrv',function(b){var e=null,j=function(){!1==e.showFAB&&0!=b.pageYOffset?(e.showFAB=!0,e.$apply()):!0==e.showFAB&&0==b.pageYOffset&&(e.showFAB=!1,e.$apply())};return{off:function(){angular.element(b).off('scroll',j),e=null},on:function(k){e=k,angular.element(b).on('scroll',j)}}}),app.factory('tickerSrv',function(b,c){var e=io.connect('https://streamer.cryptocompare.com/'),f=[],g=[];e.on('m',function(l){var o=l.substring(0,l.indexOf('~')),p={};o==CCC.STATIC.TYPE.CURRENTAGG&&(p=CCC.CURRENT.unpack(l),!isNaN(p.PRICE)&&c.$apply(function(){for(var q=0;q<f.length;q++)g[q]===p.FROMSYMBOL&&f[q].call(e,p)}))});return{unsub:function(l){f.pop(),g.pop(),'ETH'!==l&&'BTC'!==l&&e.emit('SubRemove',{subs:['5~CCCAGG~'+l+'~USD']})},subscribe:function(l,o){f.push(o),g.push(l),e.emit('SubAdd',{subs:['5~CCCAGG~'+l+'~USD']})}}}),app.component('userDetails',{controller:function(b,c,e,f){b.userId=e.params.userId,f.authenticated({avatarImage:!0,email:!0}).then(function(j){console.log(j),b.image=String.fromCharCode.apply(null,j[0].avatarImage.data)})},templateUrl:'public/templates/userDetails.html'}),app.factory('userSrv',function(b,c,e){var f=function(l){return b({method:'POST',url:'/user',data:l})};return{authenticated:function(l){var o=null,p=c.defer();return f(l).then(function(q){o=q.data,401==q.data.status?p.reject(q.data):p.resolve(q.data)},function(q){o=q,p.reject(q)}),o=p.promise,c.when(o)},signIn:function(l){return f(l).then(function(o){if(200==o.data.status)return e.go('coinlist');return 401==o.data.status?401:void 0})}}});